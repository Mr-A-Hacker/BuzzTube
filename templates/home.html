{% extends "base.html" %}
{% block content %}

<!-- Splash Overlay -->
<div id="splash" class="splash">
  <h1 class="neon-text big-title splash-text">BuzzTube</h1>
</div>

<!-- Main Content -->
<div id="main-content" style="display:none;">
  <div class="container">
    <h1 class="neon-text big-title">BuzzTube Home</h1>

    <!-- Video Feed -->
    <ul class="video-list">
      {% for v in videos %}
        <li class="card three-d-card">
          <!-- Video Title -->
          <h2 class="neon-text three-d-text">{{ v.title }}</h2>
          <p class="meta">Uploaded by {{ v.uploader }}</p>

          <!-- Video Preview -->
          {% if v.filepath %}
            <div class="three-d-video">
              <video controls width="100%" preload="metadata">
                <source src="{{ v.filepath }}" type="video/mp4">
                Your browser does not support the video tag.
              </video>
            </div>
          {% else %}
            <p class="flash warning">No video file available.</p>
          {% endif %}

          <!-- Actions -->
          <div class="actions three-d-actions">
            <form action="{{ url_for('like_video', id=v.id) }}" method="POST">
              <button type="submit" class="btn three-d-btn">Like ({{ v.likes }})</button>
            </form>
            <form action="{{ url_for('follow_user', username=v.uploader) }}" method="POST">
              <button type="submit" class="btn three-d-btn">Follow {{ v.uploader }}</button>
            </form>
            <a class="btn three-d-btn" href="{{ url_for('video', id=v.id) }}">Watch</a>
          </div>

          <!-- Comment Box -->
          <form action="{{ url_for('video', id=v.id) }}" method="POST" class="neon-form-inline">
            <div class="neon-field">
              <label class="neon-label" for="c-{{ v.id }}">Comment</label>
              <input id="c-{{ v.id }}" type="text" name="text" placeholder="Write a commentâ€¦" class="neon-input">
            </div>
            <button type="submit" class="btn three-d-btn">Post</button>
          </form>
        </li>
      {% else %}
        <li class="meta">No videos found. Upload one to get started!</li>
      {% endfor %}
    </ul>
  </div>
</div>

<!-- Styles -->
<style>
  /* Splash */
  .splash {
    position:fixed; inset:0;
    background:#000; display:flex;
    justify-content:center; align-items:center;
    z-index:9999;
  }
  .splash-text {
    animation: pulseScale 2s infinite;
    text-shadow: 0 0 25px #ff33aa, 0 0 50px #ff66cc, 0 0 80px #ff99dd;
    transform: perspective(1000px) rotateY(10deg);
  }
  @keyframes pulseScale {
    0% { transform: scale(1) rotateY(0deg); }
    25% { transform: scale(1.3) rotateY(10deg); }
    50% { transform: scale(0.9) rotateY(-10deg); }
    75% { transform: scale(1.4) rotateY(5deg); }
    100% { transform: scale(1) rotateY(0deg); }
  }

  /* 3D cards */
  .three-d-card {
    background:#111; border-radius:16px; padding:20px; margin-bottom:25px;
    box-shadow: 0 0 25px #ff33aa, 0 0 50px rgba(255,102,204,0.4);
    transform: perspective(1200px) rotateX(6deg) rotateY(-4deg) translateZ(10px);
    transition: transform .4s ease, box-shadow .4s ease;
  }
  .three-d-card:hover {
    transform: perspective(1200px) rotateX(0deg) rotateY(0deg) scale(1.06) translateZ(20px);
    box-shadow: 0 0 60px #ff66cc, 0 0 100px rgba(255,51,170,0.6);
  }

  .three-d-text { text-shadow: 0 0 20px #ff33aa, 0 0 40px #ff66cc; }

  /* 3D video */
  .three-d-video video {
    border-radius:14px; box-shadow: 0 0 35px #ff33aa;
    transform: rotateY(-8deg) translateZ(25px);
    transition: transform .4s ease, box-shadow .4s ease;
  }
  .three-d-video video:hover {
    transform: rotateY(0deg) translateZ(40px) scale(1.05);
    box-shadow: 0 0 70px #ff66cc;
  }

  /* 3D buttons */
  .three-d-btn {
    background:#ff33aa; color:#fff; border:none; padding:12px 20px; border-radius:12px; font-weight:700;
    box-shadow: 0 0 25px #ff33aa; transform: perspective(600px) translateZ(15px);
    transition: transform .3s ease, box-shadow .3s ease, background .3s ease, color .3s ease;
    margin-right:12px;
  }
  .three-d-btn:hover {
    transform: perspective(600px) translateZ(30px) scale(1.12);
    box-shadow: 0 0 50px #ff66cc, 0 0 80px #ff33aa;
    background:#ff66cc; color:#000;
  }

  /* Neon Text Boxes */
  .neon-form-inline {
    display:flex; gap:14px; align-items:flex-end; margin-top:18px; flex-wrap:wrap;
  }
  .neon-field { flex:1; display:flex; flex-direction:column; gap:8px; }

  .neon-label {
    color:#ff66cc; font-weight:700; letter-spacing:.02em;
    text-shadow: 0 0 8px #ff33aa;
  }

  .neon-input {
    width:100%;
    padding:14px 18px;
    border:1px solid rgba(255,102,204,0.4);
    border-radius:14px;
    background:#0a0a0a;
    color:#ff66cc;
    font-size:1rem;
    font-weight:600;
    outline:none;
    box-shadow:
      inset 0 0 12px rgba(255,51,170,0.4),
      inset 0 0 22px rgba(255,102,204,0.3),
      0 0 14px rgba(255,51,170,0.4),
      0 0 28px rgba(255,102,204,0.5);
    transform: perspective(1000px) translateZ(12px);
    transition: border-color .3s ease, box-shadow .3s ease, transform .3s ease, background .3s ease;
  }

  .neon-input::placeholder {
    color:#ff99dd;
    text-shadow: 0 0 8px #ff33aa;
    font-style:italic;
    opacity:.9;
  }

  .neon-input:hover {
    border-color: rgba(255,102,204,0.8);
    box-shadow:
      inset 0 0 18px rgba(255,102,204,0.45),
      inset 0 0 28px rgba(255,51,170,0.35),
      0 0 22px rgba(255,102,204,0.6),
      0 0 40px rgba(255,51,170,0.5);
    transform: perspective(1000px) translateZ(20px);
  }

  .neon-input:focus {
    background: linear-gradient(160deg, #0a0a0a 0%, #151515 100%);
    border-color:#ff66cc;
    box-shadow:
      inset 0 0 24px rgba(255,102,204,0.65),
      inset 0 0 36px rgba(255,51,170,0.5),
      0 0 30px rgba(255,102,204,0.9),
      0 0 60px rgba(255,51,170,0.6);
    transform: perspective(1000px) translateZ(30px) scale(1.06);
  }
</style>

<!-- Script -->
<script>
  function showSplash(callback) {
    const
