{% extends "base.html" %}
{% block content %}

<div class="container">
  <h1 class="neon-text">BuzzTub Home</h1>

  <!-- Search bar -->
  <form method="get" action="{{ url_for('home') }}">
    <input type="text" name="q" placeholder="Search videos or creators..." value="{{ request.args.get('q','') }}">
    <button type="submit" class="btn">Search</button>
  </form>

  <!-- Upload button -->
  {% if session.get('user') %}
    <div style="margin:1rem 0;">
      <a href="{{ url_for('upload') }}" class="btn">Upload Video</a>
    </div>
  {% endif %}

  <!-- Video list -->
  {% if videos %}
    <div class="video-grid">
      {% for video in videos %}
        <div class="card">
          <h2>{{ video.title }}</h2>
          <p>Uploaded by <a href="{{ url_for('user_profile', username=video.uploader) }}">{{ video.uploader }}</a></p>
          <video width="100%" controls>
            <source src="{{ url_for('uploads', filename=video.filename) }}" type="video/mp4">
            Your browser does not support the video tag.
          </video>
          <p>Likes: {{ video.likes }}</p>
          <form method="post" action="{{ url_for('like', id=video.id) }}">
            <button type="submit" class="btn">üëç Like</button>
          </form>
          <a href="{{ url_for('video', id=video.id) }}" class="btn">View & Comment</a>
        </div>
      {% endfor %}
    </div>
  {% else %}
    <p>No videos yet. Be the first to upload!</p>
  {% endif %}
</div>

{% endblock %}
