{% extends "base.html" %}
{% block content %}

<div class="container">
  <h1 class="neon-text big-title">Admin Dashboard</h1>

  <!-- Videos Section -->
  <div class="card">
    <h2 class="neon-text">Videos</h2>
    <ul class="video-list">
      {% for v in videos %}
        <li>
          <strong>{{ v['title'] }}</strong> by {{ v['uploader'] }}
          <span class="meta">Video #{{ v['id'] }} • Likes: {{ v['likes'] }}</span>
          <form action="{{ url_for('admin_delete_video', id=v['id']) }}" method="POST" style="display:inline;">
            <button type="submit" class="btn danger">Delete</button>
          </form>
        </li>
      {% else %}
        <li class="meta">No videos found.</li>
      {% endfor %}
    </ul>
  </div>

  <!-- Comments Section -->
  <div class="card">
    <h2 class="neon-text">Comments</h2>
    <ul class="comment-list">
      {% for c in comments %}
        <li>
          <strong>{{ c['user'] }}</strong>: {{ c['text'] }}
          <span class="meta">Comment #{{ c['id'] }} on Video #{{ c['video_id'] }}</span>
          <form action="{{ url_for('admin_delete_comment', id=c['id']) }}" method="POST" style="display:inline;">
            <button type="submit" class="btn danger">Delete</button>
          </form>
        </li>
      {% else %}
        <li class="meta">No comments found.</li>
      {% endfor %}
    </ul>
  </div>

  <!-- Users Section -->
  <div class="card">
    <h2 class="neon-text">Users</h2>
    <ul class="user-list">
      {% for u in users %}
        <li>
          <strong>{{ u['username'] }}</strong>
          <span class="meta">User #{{ u['id'] }}{% if u['premium'] %} • Premium{% endif %}</span>

          {% if u['username'] != 'admin' %}
            <form action="{{ url_for('admin_grant_premium', id=u['id']) }}" method="POST" style="display:inline;">
              <button type="submit" class="btn">Grant Premium</button>
            </form>
            <form action="{{ url_for('admin_kick_user', id=u['id']) }}" method="POST" style="display:inline;">
              <button type="submit" class="btn danger">Kick</button>
            </form>
          {% else %}
            <span class="meta">Protected</span>
          {% endif %}
        </li>
      {% else %}
        <li class="meta">No users found.</li>
      {% endfor %}
    </ul>
  </div>

  <!-- Reports Section -->
  <div class="card">
    <h2 class="neon-text">Reports</h2>
    <ul class="report-list">
      {% for r in reports %}
        <li>
          <strong>{{ r['reporter'] }}</strong> reported <strong>{{ r['reported_user'] }}</strong>
          <span class="meta">Reason: {{ r['reason'] }} • Status: {{ r['status'] }}</span>
          {% if r['status'] == 'pending' %}
            <form action="{{ url_for('admin_mark_report_reviewed', id=r['id']) }}" method="POST" style="display:inline;">
              <button type="submit" class="btn">Mark Reviewed</button>
            </form>
          {% endif %}
        </li>
      {% else %}
        <li class="meta">No reports found.</li>
      {% endfor %}
    </ul>
  </div>

  <!-- Publichat Messages Section -->
  <div class="card">
    <h2 class="neon-text">Publichat Messages</h2>
    <ul class="chat-list">
      {% for m in messages %}
        <li>
          <strong>{{ m['user'] }}</strong>: {{ m['message'] }}
          <span class="meta">Message #{{ m['id'] }}</span>
          <form action="{{ url_for('admin_delete_message', id=m['id']) }}" method="POST" style="display:inline;">
            <button type="submit" class="btn danger">Delete</button>
          </form>
        </li>
      {% else %}
        <li class="meta">No messages found.</li>
      {% endfor %}
    </ul>
  </div>
</div>

{% endblock %}
