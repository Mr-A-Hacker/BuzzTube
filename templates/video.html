{% extends "base.html" %}
{% block content %}

<div class="container">
  <div class="card">
    <h1 class="neon-text">{{ video.title }}</h1>
    <p>Uploaded by <a href="{{ url_for('user_profile', username=video.uploader) }}">{{ video.uploader }}</a></p>

    <!-- Video player -->
    <video width="100%" controls>
      <source src="{{ url_for('uploads', filename=video.filename) }}" type="video/mp4">
      Your browser does not support the video tag.
    </video>

    <!-- Likes -->
    <p>Likes: {{ video.likes }}</p>
    <form method="post" action="{{ url_for('like', id=video.id) }}">
      <button type="submit" class="btn">üëç Like</button>
    </form>
  </div>

  <!-- Comments -->
  <div class="card">
    <h2 class="neon-text">Comments</h2>
    {% if comments %}
      <ul>
        {% for comment in comments %}
          <li>
            <strong>{{ comment.user }}</strong> ({{ comment.created_at.strftime("%Y-%m-%d %H:%M") }}):  
            {{ comment.text }}
          </li>
        {% endfor %}
      </ul>
    {% else %}
      <p>No comments yet. Be the first to comment!</p>
    {% endif %}

    {% if session.get('user') %}
      <form method="post" action="{{ url_for('comment', id=video.id) }}">
        <textarea name="text" placeholder="Write a comment..." required></textarea>
        <button type="submit" class="btn">Post Comment</button>
      </form>
    {% else %}
      <p><a href="{{ url_for('login') }}">Log in</a> to post a comment.</p>
    {% endif %}
  </div>
</div>

{% endblock %}
